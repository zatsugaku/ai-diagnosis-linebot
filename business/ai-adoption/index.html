<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ü§ñ AIÊ¥ªÁî®Â∫¶Ë®∫Êñ≠ - 3ÂàÜ„ÅßÂà§Êòé„Åô„Çã„ÅÇ„Å™„Åü„ÅÆ‰ºöÁ§æ„ÅÆÁúü„ÅÆÂÆüÂäõ</title>
  <meta name="description" content="1,200Á§æ„ÅÆÂÆüÁ∏æ„Éá„Éº„Çø„ÇíÂü∫„Å´„ÄÅË≤¥Á§æ„ÅÆAIÊ¥ªÁî®„Éù„ÉÜ„É≥„Ç∑„É£„É´„ÇíÂÆ¢Ë¶≥ÁöÑ„Å´Êï∞ÂÄ§Âåñ„ÄÇÂ∞ÇÈñÄAIÂàÜÊûê„Å´„Çà„ÇãË©≥Á¥∞„É¨„Éù„Éº„Éà„ÇíÁÑ°ÊñôÊèê‰æõ„ÄÇ">
  <meta name="keywords" content="AIÊ¥ªÁî®Ë®∫Êñ≠,AIÂ∞éÂÖ•,ÁîüÊàêAI,ChatGPT,Claude,Ê•≠ÂãôÂäπÁéáÂåñ,DXÊé®ÈÄ≤">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; color: #333; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 10px; }
    .container { max-width: 900px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 20px 40px rgba(0,0,0,0.15); overflow: hidden; min-height: 95vh; display: flex; flex-direction: column; }
    .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; text-align: center; padding: 30px 30px 20px; position: relative; overflow: hidden; flex-shrink: 0; }
    .header::before { content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(255,255,255,0.1) 10px, rgba(255,255,255,0.1) 20px); animation: backgroundMove 20s linear infinite; }
    @keyframes backgroundMove { 0% { transform: translate(-50%, -50%) rotate(0deg); } 100% { transform: translate(-50%, -50%) rotate(360deg); } }
    .header-content { position: relative; z-index: 2; }
    .header h1 { font-size: 2.2em; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); font-weight: 700; }
    .header .subtitle { font-size: 1.1em; opacity: 0.95; margin-bottom: 15px; font-weight: 500; }
    .header .description { font-size: 1em; opacity: 0.9; max-width: 700px; margin: 0 auto; line-height: 1.4; }
    .main-content { flex: 1; display: flex; flex-direction: column; padding: 20px; justify-content: center; }
    .progress-container { margin-bottom: 20px; flex-shrink: 0; }
    .progress-info { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
    .progress-text { font-size: 1em; font-weight: 600; color: #667eea; }
    .progress-bar { width: 100%; height: 8px; background: linear-gradient(90deg, #e9ecef 0%, #f8f9fa 100%); border-radius: 4px; overflow: hidden; box-shadow: inset 0 2px 4px rgba(0,0,0,0.1); }
    .progress-fill { height: 100%; background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); width: 0%; transition: width 0.8s ease; border-radius: 4px; position: relative; }
    .progress-fill::after { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent); animation: progressShine 2s infinite; }
    @keyframes progressShine { 0% { transform: translateX(-100%); } 100% { transform: translateX(100%); } }
    .question-container { flex: 1; display: flex; align-items: center; justify-content: center; min-height: 0; }
    .question-card { background: linear-gradient(135deg, #f8faff 0%, #e8f1ff 100%); border-radius: 20px; padding: 30px; box-shadow: 0 10px 30px rgba(102, 126, 234, 0.15); border: 2px solid rgba(102, 126, 234, 0.1); position: relative; overflow: hidden; animation: slideInFromBottom 0.6s ease-out; width: 100%; max-width: 800px; }
    @keyframes slideInFromBottom { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    .question-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 5px; background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); }
    .question-category { background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); color: white; padding: 6px 16px; border-radius: 20px; font-size: 0.85em; display: inline-block; margin-bottom: 20px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; }
    .question-text { font-size: 1.3em; font-weight: 600; margin-bottom: 25px; color: #2d3436; line-height: 1.4; }
    .options-container { display: grid; gap: 12px; margin-bottom: 20px; }
    .option { background: white; border: 2px solid #e0e6ff; border-radius: 12px; padding: 18px 22px; cursor: pointer; transition: all 0.4s ease; font-size: 1em; position: relative; overflow: hidden; font-weight: 500; }
    .option::before { content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.1), transparent); transition: left 0.6s ease; }
    .option:hover { border-color: #667eea; background: #f0f2ff; transform: translateY(-2px); box-shadow: 0 8px 25px rgba(102, 126, 234, 0.2); }
    .option:hover::before { left: 100%; }
    .option.selected { border-color: #667eea; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; transform: translateY(-2px); box-shadow: 0 12px 30px rgba(102, 126, 234, 0.4); }
    .integrated-feedback { background: linear-gradient(135deg, #00b894 0%, #00cec9 100%); color: white; padding: 20px; border-radius: 12px; margin-top: 20px; display: none; box-shadow: 0 8px 25px rgba(0, 184, 148, 0.3); border: 2px solid rgba(255,255,255,0.2); animation: slideInFromRight 0.5s ease-out; }
    @keyframes slideInFromRight { from { opacity: 0; transform: translateX(20px); } to { opacity: 1; transform: translateX(0); } }
    .feedback-title { font-size: 1.2em; font-weight: bold; margin-bottom: 12px; display: flex; align-items: center; gap: 10px; }
    .feedback-content { font-size: 1em; line-height: 1.5; opacity: 0.95; }
    .navigation { display: flex; justify-content: space-between; align-items: center; margin-top: 20px; gap: 15px; flex-shrink: 0; }
    .nav-button { padding: 15px 35px; border: none; border-radius: 25px; font-size: 1.1em; font-weight: 600; cursor: pointer; transition: all 0.3s ease; position: relative; overflow: hidden; flex: 1; max-width: 200px; }
    .nav-button:disabled { opacity: 0.5; cursor: not-allowed; transform: none !important; }
    .prev-button { background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%); color: white; }
    .prev-button:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(149, 165, 166, 0.4); }
    .next-button { background: linear-gradient(135deg, #00b894 0%, #00cec9 100%); color: white; }
    .next-button:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0, 184, 148, 0.4); }
    .ai-analysis-button { background: linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%); color: white; border: none; padding: 18px 45px; border-radius: 25px; font-size: 1.3em; font-weight: 600; cursor: pointer; transition: all 0.3s ease; margin: 20px auto; display: block; box-shadow: 0 10px 30px rgba(108, 92, 231, 0.3); width: 100%; max-width: 350px; }
    .ai-analysis-button:hover { transform: translateY(-3px); box-shadow: 0 15px 35px rgba(108, 92, 231, 0.4); }
    .loading-container { text-align: center; margin: 30px 0; display: none; background: linear-gradient(135deg, #f8faff 0%, #e8f1ff 100%); padding: 30px; border-radius: 20px; border: 2px solid rgba(102, 126, 234, 0.1); }
    .loading-container h2 { color: #667eea; margin-bottom: 25px; font-size: 1.8em; }
    .loading-step { padding: 15px 25px; margin: 12px 0; border-radius: 10px; background: white; transition: all 0.4s ease; border: 1px solid #e0e6ff; display: flex; align-items: center; justify-content: space-between; font-size: 0.95em; }
    .loading-step.active { background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%); border-left: 4px solid #fdcb6e; transform: translateX(10px); }
    .loading-step.completed { background: linear-gradient(135deg, #d4edda 0%, #a8e6cf 100%); border-left: 4px solid #00b894; transform: translateX(5px); }
    .results-card { background: linear-gradient(135deg, #00b894 0%, #00cec9 100%); color: white; padding: 40px; border-radius: 25px; text-align: center; margin-top: 30px; display: none; box-shadow: 0 20px 45px rgba(0, 184, 148, 0.3); border: 3px solid rgba(255,255,255,0.2); animation: slideInFromBottom 0.8s ease-out; }
    .score-display { font-size: 4.5em; font-weight: bold; margin: 25px 0; text-shadow: 3px 3px 6px rgba(0,0,0,0.3); background: rgba(255,255,255,0.2); border-radius: 20px; padding: 25px; display: inline-block; min-width: 250px; }
    .improvement-amount { font-size: 2.2em; margin: 25px 0; padding: 18px; background: rgba(255,255,255,0.15); border-radius: 15px; font-weight: 600; }
    .score-analysis { background: rgba(255,255,255,0.1); padding: 25px; border-radius: 15px; margin: 25px 0; text-align: left; }
    .ai-analysis-card { margin-top: 30px; background: linear-gradient(135deg, #f8faff 0%, #e8f1ff 100%); border-radius: 20px; padding: 35px; display: none; border: 2px solid #667eea; box-shadow: 0 12px 30px rgba(102, 126, 234, 0.1); animation: slideInFromBottom 0.8s ease-out; }
    .cta-section { background: linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%); color: white; padding: 35px; border-radius: 20px; text-align: center; margin-top: 30px; border: 2px solid rgba(255,255,255,0.2); }
    .cta-section h2 { margin-bottom: 18px; font-size: 2em; }
    .cta-section p { font-size: 1.1em; margin-bottom: 20px; opacity: 0.95; }
    .cta-button { background: white; color: #6c5ce7; padding: 18px 40px; border: none; border-radius: 25px; font-size: 1.2em; font-weight: bold; cursor: pointer; transition: all 0.3s ease; margin: 15px 10px; text-decoration: none; display: inline-block; box-shadow: 0 8px 25px rgba(255,255,255,0.2); min-width: 220px; }
    .cta-button:hover { transform: translateY(-3px); box-shadow: 0 15px 35px rgba(255,255,255,0.3); }
    .highlight-box { background: linear-gradient(135deg, #e8f4f8 0%, #d1ecf1 100%); padding: 25px; border-radius: 12px; margin: 25px 0; border-left: 5px solid #00b894; box-shadow: 0 6px 20px rgba(0, 184, 148, 0.1); }
    .loading-spinner { display: inline-block; width: 20px; height: 20px; border: 2px solid rgba(255,255,255,0.3); border-radius: 50%; border-top-color: #667eea; animation: spin 1s ease-in-out infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
    @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.6; } 100% { opacity: 1; } }
    .loading-step .spinner { animation: pulse 1.5s infinite; }
    .error-message { background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%); color: white; padding: 25px; border-radius: 12px; margin: 25px 0; text-align: center; box-shadow: 0 8px 25px rgba(255, 107, 107, 0.3); }
    @media (max-width: 768px) {
      body { padding: 5px; }
      .container { border-radius: 15px; min-height: 98vh; }
      .header { padding: 20px 15px 15px; }
      .header h1 { font-size: 1.8em; }
      .header .subtitle { font-size: 1em; }
      .header .description { font-size: 0.9em; }
      .main-content { padding: 15px; }
      .question-card { padding: 25px 20px; }
      .question-text { font-size: 1.2em; }
      .option { padding: 16px 18px; font-size: 0.95em; }
      .navigation { flex-direction: column; gap: 12px; }
      .nav-button { width: 100%; max-width: none; padding: 16px 30px; }
      .score-display { font-size: 3.2em; min-width: auto; padding: 20px; }
      .improvement-amount { font-size: 1.6em; }
      .ai-analysis-button { width: 100%; max-width: none; padding: 16px 35px; font-size: 1.2em; }
      .cta-button { width: 100%; min-width: auto; margin: 8px 0; }
      .loading-step { font-size: 0.9em; padding: 12px 18px; }
    }
    .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border: 0; }
  </style>
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="header-content">
        <h1>ü§ñ AIÊ¥ªÁî®Â∫¶Ë®∫Êñ≠</h1>
        <div class="subtitle">3ÂàÜ„ÅßÂà§Êòé„Åô„Çã„ÅÇ„Å™„Åü„ÅÆ‰ºöÁ§æ„ÅÆ„ÄåÁúü„ÅÆÂÆüÂäõ„Äç</div>
        <div class="description">
          1,200Á§æ„ÅÆÂÆüÁ∏æ„Éá„Éº„Çø„ÇíÂü∫„Å´„ÄÅË≤¥Á§æ„ÅÆAIÊ¥ªÁî®„Éù„ÉÜ„É≥„Ç∑„É£„É´„ÇíÂÆ¢Ë¶≥ÁöÑ„Å´Êï∞ÂÄ§Âåñ„ÄÇ
          Áâπ„Å´„Äå‰∫∫Êùê„ÅÆÊΩúÂú®ËÉΩÂäõ„Äç„Å®„ÅÑ„ÅÜÊúÄ„ÇÇÈáçË¶Å„Å™Ë≥áÁî£„Å´ÁùÄÁõÆ„Åó„ÅüË®∫Êñ≠„Ç∑„Çπ„ÉÜ„É†„Åß„Åô„ÄÇ
        </div>
      </div>
    </header>

    <main class="main-content">
      <div class="progress-container">
        <div class="progress-info">
          <span class="progress-text" id="progress-text">Ë≥™Âïè1 / 10</span>
          <span class="progress-text" id="completion-rate">ÂÆå‰∫ÜÁéá: 10%</span>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" id="progress-fill"></div>
        </div>
      </div>

      <div class="question-container" id="question-container">
        <div class="question-text" id="loading-message">AIË®∫Êñ≠„Ç∑„Çπ„ÉÜ„É†„ÇíÂàùÊúüÂåñ‰∏≠...</div>
      </div>

      <nav class="navigation">
        <button class="nav-button prev-button" id="prev-button" onclick="diagnosisSystem.previousQuestion()" disabled aria-label="Ââç„ÅÆË≥™Âïè„Å´Êàª„Çã">
          ‚Üê Ââç„ÅÆË≥™Âïè„Å´Êàª„Çã
        </button>
        <button class="nav-button next-button" id="next-button" onclick="diagnosisSystem.nextQuestion()" disabled aria-label="Ê¨°„ÅÆË≥™Âïè„Å∏ÈÄ≤„ÇÄ">
          Ê¨°„ÅÆË≥™Âïè„Å∏ ‚Üí
        </button>
      </nav>

      <button class="ai-analysis-button" id="ai-analysis-button" onclick="diagnosisSystem.startAIAnalysis()" style="display: none;" aria-label="AIÂàÜÊûê„ÇíÈñãÂßã">
        ü§ñ AIË©≥Á¥∞ÂàÜÊûê„ÇíÈñãÂßã
      </button>

      <div class="loading-container" id="loading-container">
        <h2>ü§ñ AIÂ∞ÇÈñÄÂàÜÊûêÂÆüË°å‰∏≠...</h2>
        <div class="loading-step" id="step1">
          <span>üîç 1,200Á§æ„ÅÆ„Éô„É≥„ÉÅ„Éû„Éº„ÇØ„Éá„Éº„Çø„Å®ÁÖßÂêà‰∏≠...</span>
          <span class="spinner">‚è≥</span>
        </div>
        <div class="loading-step" id="step2">
          <span>üìä AIÊ¥ªÁî®Ë™≤È°å„Å®ÊîπÂñÑ„Éù„Ç§„É≥„Éà„ÇíÁâπÂÆö‰∏≠...</span>
          <span class="spinner">‚è≥</span>
        </div>
        <div class="loading-step" id="step3">
          <span>üéØ ÊúÄÈÅ©„Å™AIÂ∞éÂÖ•Êà¶Áï•„ÇíÁîüÊàê‰∏≠...</span>
          <span class="spinner">‚è≥</span>
        </div>
        <div class="loading-step" id="step4">
          <span>üí∞ ROI„ÉªÊäïË≥áÂäπÊûú„ÇíÁ≤æÂØÜÁÆóÂá∫‰∏≠...</span>
          <span class="spinner">‚è≥</span>
        </div>
        <div class="loading-step" id="step5">
          <span>üìã ÂÄãÂà•„Ç´„Çπ„Çø„Éû„Ç§„Ç∫„É¨„Éù„Éº„Éà„ÇíÂÆåÊàê‰∏≠...</span>
          <span class="spinner">‚è≥</span>
        </div>
      </div>

      <div class="results-card" id="results-card">
        <h2>üìä AIÊ¥ªÁî®Â∫¶Ë®∫Êñ≠ÁµêÊûú</h2>
        <div class="score-display" id="final-score">0ÁÇπ</div>
        <div class="improvement-amount" id="final-amount">Âπ¥ÈñìÊîπÂñÑÂäπÊûú: 0‰∏áÂÜÜ</div>
        <div class="score-analysis" id="score-message">
          <h3>üéØ AIÊ¥ªÁî®„Éù„ÉÜ„É≥„Ç∑„É£„É´Ë©ï‰æ°</h3>
          <p id="position-message">ÂàÜÊûê„É°„ÉÉ„Çª„Éº„Ç∏</p>
          <h3>üöÄ Êé®Â•®„Ç¢„ÇØ„Ç∑„Éß„É≥„Éó„É©„É≥</h3>
          <p id="action-message">Êé®Â•®„Ç¢„ÇØ„Ç∑„Éß„É≥</p>
        </div>
      </div>

      <div class="ai-analysis-card" id="ai-analysis-section">
        <div id="analysis-content"></div>
      </div>

      <div class="cta-section">
        <h2>üöÄ ÁÑ°ÊñôAIÊ¥ªÁî®Êà¶Áï•Áõ∏Ë´á</h2>
        <p>„Åì„ÅÆË®∫Êñ≠ÁµêÊûú„ÇíÂü∫„Å´„ÄÅË≤¥Á§æÂ∞ÇÁî®„ÅÆAIÊ¥ªÁî®„É≠„Éº„Éâ„Éû„ÉÉ„Éó„ÇíÁÑ°Êñô„Åß‰ΩúÊàê„ÅÑ„Åü„Åó„Åæ„Åô„ÄÇ</p>
        <p>60ÂàÜ„ÅÆÂÄãÂà•Áõ∏Ë´á„Åß„ÄÅÂÖ∑‰ΩìÁöÑ„Å™Â∞éÂÖ•Ë®àÁîª„Å®ÊäïË≥áÂØæÂäπÊûú„ÇíË©≥Á¥∞Ë®≠Ë®à„ÄÇ</p>
        <a href="mailto:ai-consulting@business.com?subject=AIÊ¥ªÁî®Ë®∫Êñ≠ÁµêÊûú„ÅÆÁõ∏Ë´á&body=Ë®∫Êñ≠ÁµêÊûú„ÇíÂü∫„Å´AIÊ¥ªÁî®Êà¶Áï•„ÅÆÁõ∏Ë´á„ÇíÂ∏åÊúõ„Åó„Åæ„Åô„ÄÇ" class="cta-button">
          üìß ÁÑ°ÊñôÂÄãÂà•Áõ∏Ë´á„ÇíÁî≥„ÅóËæº„ÇÄ
        </a>
      </div>
    </main>
  </div>

  <!-- Ë®≠ÂÆöJSON„ÅÆË™≠„ÅøËæº„Åø„Å®Ëµ∑Âãï -->
  <script>
    async function loadConfigAndBoot() {
      try {
        const url = new URL(location.href);
        const set = url.searchParams.get('set') || 'default';

        // 1) Serverless APIÔºà„ÅÇ„Çå„Å∞Ôºâ„Åã„ÇâÂèñÂæó
        let endpoint = `/api/config?set=${encodeURIComponent(set)}`;
        let res = await fetch(endpoint);

        // 2) ÁÑ°„Åë„Çå„Å∞ÈùôÁöÑJSON„Å´„Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØ
        if (!res.ok) {
          endpoint = `/configs/${encodeURIComponent(set)}.json`;
          res = await fetch(endpoint);
        }
        if (!res.ok) throw new Error(`Ë®≠ÂÆö„ÅÆÂèñÂæó„Å´Â§±Êïó: ${res.status}`);

        const data = await res.json();
        window.QUESTION_DATA = data.questions || [];
        window.SYSTEM_CONFIG = data.system || {};

        // SYSTEM_CONFIG „ÇíUI„Å∏ÂèçÊò†
        const titleEl = document.querySelector('.header h1');
        const subtitleEl = document.querySelector('.header .subtitle');
        const ctaLink = document.querySelector('.cta-section a.cta-button');
        if (window.SYSTEM_CONFIG.title) titleEl.textContent = window.SYSTEM_CONFIG.title;
        if (window.SYSTEM_CONFIG.subtitle) subtitleEl.textContent = window.SYSTEM_CONFIG.subtitle;
        if (ctaLink && window.SYSTEM_CONFIG?.cta?.email) {
          const email = window.SYSTEM_CONFIG.cta.email;
          ctaLink.href = `mailto:${email}?subject=AIÊ¥ªÁî®Ë®∫Êñ≠ÁµêÊûú„ÅÆÁõ∏Ë´á&body=Ë®∫Êñ≠ÁµêÊûú„ÇíÂü∫„Å´AIÊ¥ªÁî®Êà¶Áï•„ÅÆÁõ∏Ë´á„ÇíÂ∏åÊúõ„Åó„Åæ„Åô„ÄÇ`;
        }

        // ÂàùÊúüÂåñ„ÅØ„Åì„Åì„Åß1Âõû„Å†„Åë
        window.diagnosisSystem = new DiagnosisSystem();
      } catch (e) {
        console.error(e);
        const qc = document.getElementById('question-container');
        qc.innerHTML = `
          <div class="error-message">
            <h3>‚ö†Ô∏è Ë®≠ÂÆö„ÅåË™≠„ÅøËæº„ÇÅ„Åæ„Åõ„Çì</h3>
            <p>URL„ÅÆ ?set=ID „ÇíÁ¢∫Ë™ç„Åô„Çã„Åã„ÄÅ/configs/ID.json „ÅåÈÖçÁΩÆ„Åï„Çå„Å¶„ÅÑ„Çã„ÅãÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
          </div>`;
      }
    }
    loadConfigAndBoot();
  </script>

  <!-- Êú¨‰Ωì„É≠„Ç∏„ÉÉ„ÇØ -->
  <script>
    class DiagnosisSystem {
      constructor() {
        this.currentQuestion = 0;
        this.answers = [];
        this.totalScore = 0;
        this.totalImprovement = 0;
        this.questionData = null;
        this.startTime = new Date();
        this.debugMode = true;
        if (this.debugMode) {
          console.log('üöÄ AIÊ¥ªÁî®Ë®∫Êñ≠„Ç∑„Çπ„ÉÜ„É†ÂàùÊúüÂåñÈñãÂßã', this.startTime.toISOString());
        }
        this.waitForQuestionData();
      }

      waitForQuestionData() {
        const checkData = () => {
          if (Array.isArray(window.QUESTION_DATA) && window.QUESTION_DATA.length > 0) {
            if (this.debugMode) {
              console.log('‚úÖ Ë≥™Âïè„Éá„Éº„ÇøË™≠„ÅøËæº„ÅøÊàêÂäü:', window.QUESTION_DATA.length, 'Âïè');
              console.log('üìù ÊúÄÂàù„ÅÆË≥™Âïè:', window.QUESTION_DATA[0]?.text?.substring(0, 50) + '...');
            }
            this.questionData = window.QUESTION_DATA;
            this.initializeDiagnosis();
          } else {
            if (this.debugMode) console.log('‚è≥ Ë≥™Âïè„Éá„Éº„ÇøË™≠„ÅøËæº„ÅøÂæÖÊ©ü‰∏≠...');
            setTimeout(checkData, 100);
          }
        };
        checkData();
      }

      initializeDiagnosis() {
        try {
          this.showQuestion();
          this.updateProgress();
          this.updateNavigation();
          if (this.debugMode) console.log('‚úÖ AIË®∫Êñ≠„Ç∑„Çπ„ÉÜ„É†ÂàùÊúüÂåñÂÆå‰∫Ü');
        } catch (error) {
          console.error('üí• ÂàùÊúüÂåñ„Ç®„É©„Éº:', error);
          this.showError('„Ç∑„Çπ„ÉÜ„É†„ÅÆÂàùÊúüÂåñ„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ„Éö„Éº„Ç∏„ÇíÂÜçË™≠„ÅøËæº„Åø„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
        }
      }

      showError(message) {
        const container = document.getElementById('question-container');
        container.innerHTML = `
          <div class="error-message">
            <h3>‚ö†Ô∏è „Ç∑„Çπ„ÉÜ„É†„Ç®„É©„Éº</h3>
            <p>${message}</p>
            <button onclick="location.reload()" class="cta-button" style="margin-top: 20px;">
              üîÑ „Éö„Éº„Ç∏„ÇíÂÜçË™≠„ÅøËæº„Åø
            </button>
          </div>
        `;
      }

      showQuestion() {
        if (!this.questionData || this.currentQuestion >= this.questionData.length) {
          this.showResults();
          return;
        }
        const question = this.questionData[this.currentQuestion];
        const container = document.getElementById('question-container');

        container.innerHTML = `
          <div class="question-card">
            <div class="question-category">${question.category || ''}</div>
            <div class="question-text">${question.text || ''}</div>
            <div class="options-container">
              ${question.options.map((option, index) => `
                <div class="option" data-index="${index}" onclick="diagnosisSystem.selectOption(${index})" role="button" tabindex="0" aria-label="ÈÅ∏ÊäûËÇ¢ ${index + 1}: ${option}">
                  ${option}
                </div>
              `).join('')}
            </div>
            <div class="integrated-feedback" id="feedback-${this.currentQuestion}">
              <div class="feedback-title"></div>
              <div class="feedback-content"></div>
            </div>
          </div>
        `;

        if (this.answers[this.currentQuestion] !== undefined) {
          this.selectOption(this.answers[this.currentQuestion].selectedIndex, false);
        }
        this.addKeyboardSupport();
      }

      addKeyboardSupport() {
        const options = document.querySelectorAll('.option');
        options.forEach((option, index) => {
          option.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
              e.preventDefault();
              this.selectOption(index);
            }
          });
        });
      }

      selectOption(optionIndex, animate = true) {
        document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
        const selectedOption = document.querySelector(`[data-index="${optionIndex}"]`);
        if (selectedOption) {
          selectedOption.classList.add('selected');
          selectedOption.setAttribute('aria-selected', 'true');
        }

        const question = this.questionData[this.currentQuestion];
        const score = question.scores[optionIndex] ?? 0;
        const amount = question.amounts[optionIndex] ?? 0;
        const feedback = (question.feedbacks && question.feedbacks[optionIndex]) || { title: '', content: '' };

        this.answers[this.currentQuestion] = {
          selectedIndex: optionIndex,
          score,
          amount,
          timestamp: new Date()
        };

        const feedbackCard = document.getElementById(`feedback-${this.currentQuestion}`);
        const feedbackTitle = feedbackCard.querySelector('.feedback-title');
        const feedbackContent = feedbackCard.querySelector('.feedback-content');
        feedbackTitle.textContent = feedback.title || '';
        feedbackContent.textContent = feedback.content || '';
        feedbackCard.style.display = 'block';

        this.updateTotals();
        this.updateNavigation();

        if (this.debugMode) {
          console.log(`Q${this.currentQuestion + 1} ÂõûÁ≠î:`, {
            option: optionIndex, score, amount,
            totalScore: this.totalScore, totalImprovement: this.totalImprovement
          });
        }
      }

      updateTotals() {
        this.totalScore = 0;
        this.totalImprovement = 0;
        this.answers.forEach(a => {
          if (a) { this.totalScore += a.score; this.totalImprovement += a.amount; }
        });
      }

      updateProgress() {
        const total = this.questionData.length || 1;
        const progress = ((this.currentQuestion + 1) / total) * 100;
        const completionRate = Math.round(progress);
        document.getElementById('progress-fill').style.width = `${progress}%`;
        document.getElementById('progress-text').textContent = `Ë≥™Âïè${this.currentQuestion + 1} / ${total}`;
        document.getElementById('completion-rate').textContent = `ÂÆå‰∫ÜÁéá: ${completionRate}%`;
      }

      updateNavigation() {
        const prevButton = document.getElementById('prev-button');
        const nextButton = document.getElementById('next-button');
        prevButton.disabled = this.currentQuestion === 0;
        nextButton.disabled = this.answers[this.currentQuestion] === undefined;

        if (this.currentQuestion === this.questionData.length - 1 && this.answers[this.currentQuestion] !== undefined) {
          nextButton.style.display = 'none';
          document.getElementById('ai-analysis-button').style.display = 'block';
        } else {
          nextButton.style.display = 'inline-block';
          document.getElementById('ai-analysis-button').style.display = 'none';
        }
      }

      previousQuestion() {
        if (this.currentQuestion > 0) {
          this.currentQuestion--;
          this.showQuestion();
          this.updateProgress();
          this.updateNavigation();
        }
      }

      nextQuestion() {
        if (this.currentQuestion < this.questionData.length - 1) {
          this.currentQuestion++;
          this.showQuestion();
          this.updateProgress();
          this.updateNavigation();
        } else {
          this.showResults();
        }
      }

      showResults() {
        document.querySelector('.navigation').style.display = 'none';
        document.getElementById('ai-analysis-button').style.display = 'block';
        document.getElementById('question-container').style.display = 'none';
        this.displayFinalResults();
      }

      displayFinalResults() {
        const resultsCard = document.getElementById('results-card');
        const finalScore = document.getElementById('final-score');
        const finalAmount = document.getElementById('final-amount');
        const positionMessage = document.getElementById('position-message');
        const actionMessage = document.getElementById('action-message');

        finalScore.textContent = `${this.totalScore}ÁÇπ`;

        if (window.SYSTEM_CONFIG?.hideAmountDisplay) {
          finalAmount.style.display = 'none';
        } else {
          finalAmount.style.display = 'block';
          finalAmount.textContent = `Âπ¥ÈñìÊîπÂñÑÂäπÊûú: ${this.totalImprovement}‰∏áÂÜÜ`;
        }

        let position, action;
        if (this.totalScore >= 70) {
          position = "üö® AIÊ¥ªÁî®„Å´„Çà„ÇãÂ§ßÂπÖ„Å™ÊîπÂñÑ‰ΩôÂú∞„ÅÇ„ÇäÔºà‰∏ä‰Ωç15%Ôºâ- Êà¶Áï•ÁöÑAIÂ∞éÂÖ•„Å´„Çà„ÇäÂäáÁöÑ„Å™ÂäπÁéáÂåñ„ÅåÊúüÂæÖ„Åß„Åç„Åæ„Åô";
          action = "Âç≥Â∫ß„Å´AIÊ¥ªÁî®Êà¶Áï•„ÅÆÁ≠ñÂÆö„ÇíÈñãÂßã„Åó„ÄÅÊÆµÈöéÁöÑ„Å™AIÂ∞éÂÖ•„ÇíÊé®ÈÄ≤„Åô„Çã„Åì„Å®„ÇíÂº∑„ÅèÊé®Â•®„Åó„Åæ„Åô";
        } else if (this.totalScore >= 50) {
          position = "‚ö° AIÊ¥ªÁî®„Å´„Çà„ÇãÊîπÂñÑ‰ΩôÂú∞„ÅÇ„ÇäÔºà‰∏ä‰Ωç35%Ôºâ- ÈÅ©Âàá„Å™AIÂ∞éÂÖ•„Å´„Çà„ÇäÂ§ß„Åç„Å™ÂäπÊûú„ÅåË¶ãËæº„ÇÅ„Åæ„Åô";
          action = "AIÊ¥ªÁî®„ÅÆÂÖ∑‰ΩìÁöÑ„Å™Ê§úË®é„ÇíÈñãÂßã„Åó„ÄÅÂÑ™ÂÖàÂ∫¶„ÅÆÈ´ò„ÅÑÊ•≠ÂãôÈ†òÂüü„Åã„ÇâAIÂ∞éÂÖ•„ÇíÈÄ≤„ÇÅ„Çã„Åì„Å®„ÇíÊé®Â•®„Åó„Åæ„Åô";
        } else if (this.totalScore >= 30) {
          position = "üìà AIÊ¥ªÁî®„ÅÆ‰∏ÄÂÆö„ÅÆÂäπÊûúÔºàÂπ≥Âùá„É¨„Éô„É´Ôºâ- Êà¶Áï•ÁöÑ„Å™AIÊ¥ªÁî®„Å´„Çà„ÇäÁ´∂‰∫âÂÑ™‰ΩçÊÄß„ÇíÁç≤Âæó„Åß„Åç„Åæ„Åô";
          action = "AIÊ¥ªÁî®„ÅÆÊÉÖÂ†±ÂèéÈõÜ„Å®Â∞èË¶èÊ®°„Å™ÂÆüË®ºÂÆüÈ®ì„Åã„ÇâÂßã„ÇÅ„ÄÅÊÆµÈöéÁöÑ„Å´AIÊ¥ªÁî®„ÇíÊã°Â§ß„Åô„Çã„Åì„Å®„ÇíÊé®Â•®„Åó„Åæ„Åô";
        } else {
          position = "‚ú® ÂäπÁéáÁöÑ„Å™ÈÅãÂñ∂Áä∂Ê≥ÅÔºà‰∏ä‰Ωç20%Ôºâ- ÂÖàÈÄ≤ÁöÑ„Å™AIÊ¥ªÁî®„Å´„Çà„ÇäÊõ¥„Å™„ÇãÁ´∂‰∫âÂÑ™‰ΩçÊÄß„ÇíÁ¢∫Á´ã„Åß„Åç„Åæ„Åô";
          action = "ÁèæÂú®„ÅÆÂäπÁéáÊÄß„ÇíÁ∂≠ÊåÅ„Åó„Å§„Å§„ÄÅÊúÄÊñ∞„ÅÆAIÊäÄË°ìÊ¥ªÁî®„ÅßÊ•≠Áïå„É™„Éº„ÉÄ„Éº„Ç∑„ÉÉ„Éó„ÇíÂº∑Âåñ„Åô„Çã„Åì„Å®„ÇíÊé®Â•®„Åó„Åæ„Åô";
        }

        positionMessage.textContent = position;
        actionMessage.textContent = action;
        resultsCard.style.display = 'block';

        if (this.debugMode) {
          console.log('üìä ÊúÄÁµÇÁµêÊûú:', { score: this.totalScore, improvement: this.totalImprovement, duration: new Date() - this.startTime });
        }
      }

      async startAIAnalysis() {
        document.getElementById('ai-analysis-button').style.display = 'none';
        const loadingContainer = document.getElementById('loading-container');
        loadingContainer.style.display = 'block';
        if (this.debugMode) console.log('ü§ñ AIÂàÜÊûêÈñãÂßã');

        await this.animateLoadingSteps();

        try {
          const analysisResult = await this.callAIAnalysis();
          this.displayAIAnalysis(analysisResult);
        } catch (error) {
          console.error('AIÂàÜÊûê„Ç®„É©„Éº:', error);
          this.displayFallbackAnalysis();
        }
        loadingContainer.style.display = 'none';
      }

      async animateLoadingSteps() {
        const steps = ['step1', 'step2', 'step3', 'step4', 'step5'];
        const durations = [1500, 2000, 1500, 1500, 1000];
        for (let i = 0; i < steps.length; i++) {
          const step = document.getElementById(steps[i]);
          step.classList.add('active');
          await new Promise(resolve => setTimeout(resolve, durations[i]));
          step.classList.remove('active');
          step.classList.add('completed');
          step.querySelector('.spinner').textContent = '‚úÖ';
        }
      }

      async callAIAnalysis() {
        const endpoint = (window.SYSTEM_CONFIG && window.SYSTEM_CONFIG.apiEndpoint) || '/api/analyze';
        const response = await fetch(endpoint, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            answers: this.answers,
            totalScore: this.totalScore,
            totalImprovement: this.totalImprovement
          })
        });
        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
        const data = await response.json();
        if (!data.success) throw new Error(data.error || 'AIÂàÜÊûê„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
        return data.analysis;
      }

      displayAIAnalysis(analysis) {
        const analysisSection = document.getElementById('ai-analysis-section');
        const analysisContent = document.getElementById('analysis-content');
        analysisContent.innerHTML = analysis;
        analysisSection.style.display = 'block';
        if (this.debugMode) console.log('‚úÖ AIÂàÜÊûêÁµêÊûúË°®Á§∫ÂÆå‰∫Ü');
      }

      displayFallbackAnalysis() {
        const analysisSection = document.getElementById('ai-analysis-section');
        const analysisContent = document.getElementById('analysis-content');
        const analysisHTML = `
          <div class="ai-analysis">
            <h3>ü§ñ AIÊ¥ªÁî®Â∫¶ÂàÜÊûê„É¨„Éù„Éº„Éà</h3>
            <div class="highlight-box">
              <h4>üìä Ë®∫Êñ≠ÁµêÊûú„Çµ„Éû„É™„Éº</h4>
              <p><strong>AIÊ¥ªÁî®„Éù„ÉÜ„É≥„Ç∑„É£„É´„Çπ„Ç≥„Ç¢Ôºö${this.totalScore}ÁÇπ/100ÁÇπ</strong></p>
              <p><strong>Âπ¥ÈñìÊîπÂñÑÂäπÊûú„Éù„ÉÜ„É≥„Ç∑„É£„É´Ôºö${this.totalImprovement}‰∏áÂÜÜË¶èÊ®°</strong></p>
              <p>Ë≤¥Á§æ„ÅÆË®∫Êñ≠ÁµêÊûú„Åã„Çâ„ÄÅAIÊ¥ªÁî®„Å´„Çà„ÇãÂ§ßÂπÖ„Å™Ê•≠ÂãôÂäπÁéáÂåñ„Å®Á´∂‰∫âÂäõÂêë‰∏ä„ÅåÊúüÂæÖ„Åß„Åç„Çã„Åì„Å®„ÅåÂà§Êòé„ÅÑ„Åü„Åó„Åæ„Åó„Åü„ÄÇ</p>
            </div>
            <h4>üéØ AIÊ¥ªÁî®ÈáçË¶ÅË™≤È°åTOP3„Å®Ëß£Ê±∫Á≠ñ</h4>
            <ol>
              <li><strong>Ê•≠ÂãôËá™ÂãïÂåñ„ÉªÂäπÁéáÂåñ</strong><br>ChatGPT/ClaudeÁ≠â„ÅÆÁîüÊàêAIÊ¥ªÁî®„Å´„Çà„ÇäÊñáÊõ∏‰ΩúÊàê„Éª„Éá„Éº„ÇøÂá¶ÁêÜÊôÇÈñì„Çí70%ÂâäÊ∏õ„ÄÅÂπ¥Èñì${Math.floor(this.totalImprovement * 0.3)}‰∏áÂÜÜË¶èÊ®°„ÅÆÂäπÊûú</li>
              <li><strong>„Éá„Éº„ÇøÊ¥ªÁî®„ÉªÊÑèÊÄùÊ±∫ÂÆöÈ´òÈÄüÂåñ</strong><br>AIÂàÜÊûê„ÉÑ„Éº„É´Â∞éÂÖ•„Å´„Çà„Çã‰∫àÊ∏¨Á≤æÂ∫¶Âêë‰∏ä„Å®ÊÑèÊÄùÊ±∫ÂÆöËøÖÈÄüÂåñ„ÅßÂπ¥Èñì${Math.floor(this.totalImprovement * 0.4)}‰∏áÂÜÜË¶èÊ®°„ÅÆÂäπÊûú</li>
              <li><strong>AI‰∫∫ÊùêËÇ≤Êàê„ÉªÁµÑÁπîÂ§âÈù©</strong><br>AI„É™„ÉÜ„É©„Ç∑„ÉºÂêë‰∏ä„Å®„Çπ„Ç≠„É´Á†î‰øÆ„Å´„Çà„ÇäÂÖ®Á§æÁöÑÁîüÁî£ÊÄßÂêë‰∏ä„ÅßÂπ¥Èñì${Math.floor(this.totalImprovement * 0.3)}‰∏áÂÜÜË¶èÊ®°„ÅÆÂäπÊûú</li>
            </ol>
            <h4>üí° ÊÆµÈöéÂà•AIÂ∞éÂÖ•„É≠„Éº„Éâ„Éû„ÉÉ„Éó</h4>
            <ol>
              <li><strong>Phase 1Ôºà1-3„É∂ÊúàÔºâÔºöAIÂü∫Áõ§ÊßãÁØâ</strong><br>ChatGPT Business„ÉªClaude ProÂ∞éÂÖ•„ÄÅAIÊ¥ªÁî®„Ç¨„Ç§„Éâ„É©„Ç§„É≥Á≠ñÂÆöÔºàÊäïË≥áÈ°ç50‰∏áÂÜÜ„ÄÅÂäπÊûúÊúàÈ°ç${Math.floor(this.totalImprovement/12 * 0.3)}‰∏áÂÜÜÔºâ</li>
              <li><strong>Phase 2Ôºà3-6„É∂ÊúàÔºâÔºöAIÊ¥ªÁî®Êã°Â§ß</strong><br>RPA„ÉªAIÂàÜÊûê„ÉÑ„Éº„É´Â∞éÂÖ•„ÄÅÈÉ®ÈñÄÂà•AIÊ¥ªÁî®Êé®ÈÄ≤ÔºàÊäïË≥áÈ°ç150‰∏áÂÜÜ„ÄÅÂäπÊûúÊúàÈ°ç${Math.floor(this.totalImprovement/12 * 0.5)}‰∏áÂÜÜÔºâ</li>
              <li><strong>Phase 3Ôºà6-12„É∂ÊúàÔºâÔºöAIÊà¶Áï•Â±ïÈñã</strong><br>„Ç´„Çπ„Çø„É†AI„Ç∑„Çπ„ÉÜ„É†ÊßãÁØâ„ÄÅÁ´∂‰∫âÂÑ™‰ΩçÊÄßÁ¢∫Á´ãÔºàÊäïË≥áÈ°ç300‰∏áÂÜÜ„ÄÅÂäπÊûúÊúàÈ°ç${Math.floor(this.totalImprovement/12)}‰∏áÂÜÜÔºâ</li>
            </ol>
            <h4>üìà AIÊ¥ªÁî®ROIÂàÜÊûê</h4>
            <ul>
              <li>ÂàùÊúüÊäïË≥áÈ°ç: <strong>500‰∏áÂÜÜ</strong></li>
              <li>Âπ¥Èñì„Ç≥„Çπ„ÉàÂâäÊ∏õÂäπÊûú: <strong>${Math.floor(this.totalImprovement * 0.6)}‰∏áÂÜÜ</strong></li>
              <li>Âπ¥ÈñìÂ£≤‰∏ä„ÉªÁîüÁî£ÊÄßÂêë‰∏ä: <strong>${Math.floor(this.totalImprovement * 0.4)}‰∏áÂÜÜ</strong></li>
              <li>ÊäïË≥áÂõûÂèéÊúüÈñì: <strong>${Math.ceil(500 / (this.totalImprovement / 12 || 1))}„É∂Êúà</strong></li>
              <li>3Âπ¥ÈñìÁ¥ØË®àÂäπÊûú: <strong>${(this.totalImprovement * 3) - 500}‰∏áÂÜÜ</strong></li>
            </ul>
          </div>
        `;
        analysisContent.innerHTML = analysisHTML;
        analysisSection.style.display = 'block';
        if (this.debugMode) console.log('üìã „Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØÂàÜÊûêË°®Á§∫ÂÆå‰∫Ü');
      }
    }

    // „Éá„Éê„ÉÉ„Ç∞Ë£úÂä©
    window.debugAI = {
      testAPI: async function() {
        try {
          const endpoint = (window.SYSTEM_CONFIG && window.SYSTEM_CONFIG.apiEndpoint) || '/api/analyze';
          const response = await fetch(endpoint, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ answers: [{score: 5, amount: 100}], totalScore: 5, totalImprovement: 100 })
          });
          const data = await response.json();
          console.log('API „ÉÜ„Çπ„ÉàÁµêÊûú:', data);
          return data;
        } catch (error) {
          console.error('API „ÉÜ„Çπ„Éà„Ç®„É©„Éº:', error);
          return error;
        }
      },
      showCurrentData: function() {
        if (window.diagnosisSystem?.questionData) {
          console.log('ÁèæÂú®„ÅÆË≥™Âïè„Éá„Éº„Çø:', window.diagnosisSystem.questionData);
        } else {
          console.log('Ë≥™Âïè„Éá„Éº„Çø„ÅåË™≠„ÅøËæº„Åæ„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');
        }
      },
      skipToResults: function() {
        if (window.diagnosisSystem?.questionData) {
          for (let i = 0; i < window.diagnosisSystem.questionData.length; i++) {
            window.diagnosisSystem.answers[i] = { selectedIndex: 2, score: 5, amount: 80, timestamp: new Date() };
          }
          window.diagnosisSystem.updateTotals();
          window.diagnosisSystem.showResults();
          console.log('üöÄ ÁµêÊûúÁîªÈù¢„Å´„Çπ„Ç≠„ÉÉ„Éó„Åó„Åæ„Åó„Åü');
        }
      }
    };
  </script>
</body>
</html>
